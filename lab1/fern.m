nr_it=10000;
A1=[0 0;0 0.16];
A2=[0.85 0.04;-0.04 0.85];
A3=[0.2 -0.26;0.23 0.22];
A4=[-0.15 0.28;0.26 0.24];
t1=[0; 0];
t2=[0; 1.6];
t3=[0; 1.6];
t4=[0; 0.44];
X=[0;0];
v=X;
for i=1:(nr_it-1)
    n=rand;
    if (n<0.01)
        v=A1*v+t1;
    else
        if (n<0.8)
            v=A2*v+t2;
        else
            if (n<0.9)
                v=A3*v+t3;
            else
                v=A4*v+t4;
            end
        end
    end
    X=[X v];
end
plot(X(1,:),X(2,:),'r.')